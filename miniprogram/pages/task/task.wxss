/* task.wxss - 任务详情页样式 */

page {
  height: 100vh;
  background-color: var(--bg-page);
  color: var(--text-primary);
  /* TDesign Navbar 变量 - 响应主题 */
  --td-navbar-bg-color: var(--bg-card);
  --td-navbar-color: var(--text-primary);
}

/* 主题容器 - 不影响布局 */
.container-wrap {
  height: 100vh;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

/* ============================================
   导航栏
   ============================================ */
.nav {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 20rpx 32rpx;
  height: 88rpx;
  box-sizing: border-box;
  background-color: var(--bg-card);
  border-bottom: 1px solid var(--border-light);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
}

.back-btn {
  position: absolute !important;
  left: 32rpx;
  top: 50%;
  transform: translateY(-50%);
  color: var(--text-primary) !important;
  cursor: pointer;
  z-index: 10;
  width: 72rpx;
  height: 72rpx;
  display: flex !important;
  align-items: center;
  justify-content: center;
  border-radius: var(--radius-full);
  transition: background-color 0.2s ease;
}

.back-btn:active {
  background-color: var(--bg-input);
}

.title {
  font-size: 36rpx;
  font-weight: 600;
  color: var(--text-primary);
}

/* ============================================
   Swiper 组件
   ============================================ */
.swiper-component {
  width: 100%;
  height: calc(80vh - 160rpx);
}

swiper-item {
  display: flex;
  flex-direction: column;
  height: 100%;
}

.scroll {
  flex: 1;
  overflow: auto;
  padding-bottom: 60rpx;
}

/* ============================================
   头部信息区
   ============================================ */
.header {
  padding: 48rpx 32rpx;
  color: var(--text-primary);
  flex-shrink: 0;
  text-align: center;
}

.header-word {
  font-size: 72rpx;
  font-weight: 700;
  flex-shrink: 0;
  text-align: center;
  word-wrap: break-word;
  background: var(--gradient-primary);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  margin-bottom: 16rpx;
}

.header-subtitle {
  font-size: 32rpx;
  flex-shrink: 0;
  text-align: center;
  margin: 20rpx 0;
  color: var(--text-secondary);
  line-height: 1.6;
}

.header-option {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 24rpx;
  padding: 20rpx 24rpx;
  background-color: var(--bg-card);
  border-radius: var(--radius-lg);
  border: 1px solid var(--border-light);
}

.source {
  font-size: 28rpx;
  font-weight: 600;
  color: var(--primary);
  background: rgba(74, 124, 243, 0.1);
  padding: 8rpx 20rpx;
  border-radius: var(--radius-full);
}

.source-name {
  width: 55%;
  text-align: right;
  font-size: 24rpx;
  color: var(--text-muted);
}

/* ============================================
   表单组
   ============================================ */
.group-wrapper {
  margin: 0 12rpx 16rpx;
}

/* Vant Cell 样式覆盖 */
.custom-cell {
  background-color: var(--bg-card) !important;
  color: var(--text-primary) !important;
  border-radius: var(--radius-lg) !important;
  border: 1px solid var(--border-light) !important;
}

.custom-cell.van-cell {
  padding: 16rpx 18rpx !important;
}

.custom-cell .van-cell__value {
  text-align: left !important;
  white-space: normal !important;
  word-break: break-word;
  color: var(--text-primary) !important;
}

.custom-cell .van-cell__title,
.custom-cell .van-cell__value {
  color: var(--text-primary) !important;
}

.custom-cell .van-field__label {
  color: var(--text-secondary) !important;
  font-weight: 500 !important;
}

.custom-cell .van-field__control {
  color: var(--text-primary) !important;
}

/* ============================================
   TDesign Collapse 样式
   ============================================ */
.t-collapse {
  margin: 0 24rpx;
}

.t-collapse-panel {
  margin-bottom: 16rpx !important;
  border-radius: var(--radius-lg) !important;
  overflow: hidden !important;
  background-color: var(--bg-card) !important;
  border: 1px solid var(--border-light) !important;
}

.t-collapse-panel__header {
  background-color: var(--bg-card) !important;
  color: var(--text-primary) !important;
  font-weight: 600 !important;
  padding: 16rpx 24rpx !important;
}

.t-collapse-panel__content {
  background-color: var(--bg-input) !important;
  padding: 20rpx 0 !important;
}

/* ============================================
   底部按钮
   ============================================ */
.footer {
  display: flex;
  justify-content: center;
  gap: 24rpx;
  padding: 24rpx 32rpx;
  padding-bottom: calc(24rpx + constant(safe-area-inset-bottom));
  padding-bottom: calc(24rpx + env(safe-area-inset-bottom));
  background-color: var(--bg-card);
  border-top: 1px solid var(--border-light);
}

.btn-cancel,
.btn-submit {
  flex: 1;
  max-width: 280rpx;
}

.btn-submit {
  text-align: right;
}

/* 取消按钮 */
.btn-cancel-inner {
  background-color: var(--bg-input) !important;
  border: 1px solid var(--border-color) !important;
  color: var(--text-secondary) !important;
  border-radius: var(--radius-full) !important;
}

/* 确认按钮 */
.btn-submit-inner {
  background: var(--gradient-primary) !important;
  border: none !important;
  color: #fff !important;
  border-radius: var(--radius-full) !important;
  box-shadow: var(--shadow-primary) !important;
}

.btn-submit-inner.van-button--disabled {
  opacity: 0.5 !important;
  box-shadow: none !important;
}

/* ============================================
   滑动指示器
   ============================================ */
.custom-dots {
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 20rpx 0 30rpx 0;
  gap: 16rpx;
  background-color: var(--bg-page);
}

.dot {
  width: 16rpx;
  height: 16rpx;
  background-color: var(--border-color);
  border-radius: var(--radius-full);
  opacity: 0.6;
  transform: scale(1);
  transition: all 0.35s cubic-bezier(0.25, 1, 0.5, 1);
}

.dot.active {
  width: 40rpx;
  opacity: 1;
  background: var(--gradient-primary);
  transform: scale(1.1);
}

.add-icon {
  margin-left: 16rpx;
  color: var(--primary) !important;
  opacity: 0.8;
  transition: opacity 0.2s ease;
}

.add-icon:active {
  opacity: 1;
}

.hide {
  display: none;
}

/* ============================================
   提示信息
   ============================================ */
.info-text {
  padding: 20rpx 0;
  text-align: center;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text-muted);
  background-color: var(--bg-page);
}

.info-message {
  margin-left: 12rpx;
  font-size: 26rpx;
}

/* ============================================
   新增按钮
   ============================================ */
.btn-add-group {
  margin-top: 40rpx;
  display: flex;
  justify-content: center;
}

.btn-add-group .t-button {
  border: 1px dashed var(--border-color) !important;
  color: var(--primary) !important;
  background-color: transparent !important;
}

.add-item-icon {
  color: var(--primary) !important;
  margin-right: 8rpx;
}

/* ============================================
   弹出层
   ============================================ */
.popup-container {
  padding: 40rpx;
  background: var(--bg-card);
  border-radius: 32rpx 32rpx 0 0;
  color: var(--text-primary);
}

.popup-title {
  text-align: center;
  font-size: 32rpx;
  margin-bottom: 40rpx;
  color: var(--text-primary);
  font-weight: 500;
}

.popup-container .t-cell {
  background-color: var(--bg-input) !important;
  margin-bottom: 12rpx !important;
  border-radius: var(--radius-md) !important;
}

.info-icon {
  color: var(--text-muted) !important;
}

/* ============================================
   长按添加区域
   ============================================ */
.flex {
  display: flex;
  align-items: center;
  justify-content: center;
}

.longpress-view {
  width: 60%;
  min-height: 60rpx;
  background-color: var(--bg-input);
  border: 1px dashed var(--border-color);
  border-radius: var(--radius-md);
  margin: 20rpx 0;
  color: var(--text-muted);
  text-align: center;
  font-size: 24rpx;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
}

.longpress-view:active {
  background-color: var(--border-light);
  border-color: var(--primary);
  color: var(--primary);
}

/* ============================================
   删除图标
   ============================================ */
.delete-icon {
  display: flex !important;
  align-items: center;
  justify-content: center;
  width: 48rpx;
  height: 48rpx;
  border-radius: var(--radius-full);
  background: rgba(239, 68, 68, 0.1);
  color: var(--danger) !important;
  cursor: pointer;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.delete-icon:active {
  background: rgba(239, 68, 68, 0.2);
  transform: scale(0.9);
}

/* 深色模式下删除图标 */
@media (prefers-color-scheme: dark) {
  .delete-icon {
    background: rgba(239, 68, 68, 0.15);
  }
  
  .delete-icon:active {
    background: rgba(239, 68, 68, 0.25);
  }
}

.field-class {
  width: 100rpx;
}

/* ============================================
   音频组件
   ============================================ */
.audio-container {
  display: flex;
  align-items: center;
  padding: 16rpx 20rpx;
  min-height: 104rpx;
}

.audio-label {
  font-size: 28rpx;
  color: var(--text-secondary);
  width: 160rpx;
  flex-shrink: 0;
  font-weight: 500;
}

.audio-content {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.audio-controls {
  flex: 1;
  display: flex;
  align-items: center;
  gap: 16rpx;
}

/* 录音按钮 */
.record-btn {
  width: 100%;
  background: var(--bg-input);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-full);
  padding: 0 20rpx;
  min-height: 90rpx;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12rpx;
  transition: all 0.2s ease;
}

.record-btn:active {
  background-color: var(--border-light);
}

.record-btn.recording {
  background: var(--success);
  border-color: var(--success);
  transform: scale(1.02);
  box-shadow: 0 4rpx 12rpx rgba(16, 185, 129, 0.3);
}

.record-btn.recording .mic-icon {
  color: #fff !important;
}

.record-btn.recording .record-text {
  color: #fff;
}

.mic-icon {
  color: var(--text-secondary) !important;
  font-size: 32rpx;
  display: flex;
  align-items: center;
}

.record-text {
  font-size: 28rpx;
  color: var(--text-secondary);
  display: flex;
  align-items: center;
}

.audio-icon {
  background: var(--primary);
  color: #fff;
  border-radius: var(--radius-full);
  padding: 12rpx;
}

.audio-delete {
  flex-shrink: 0;
  text-align: right;
  padding-left: 16rpx;
}

/* ============================================
   Dark Mode - System Preference
   ============================================ */
@media (prefers-color-scheme: dark) {
  page {
    --td-navbar-bg-color: #161B22;
    --td-navbar-color: #F0F6FC;
  }

  .header {
    color: var(--text-primary);
  }
  
  .header-word {
    background: var(--gradient-primary);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
  }
  
  .header-option {
    background-color: var(--bg-card);
    border-color: var(--border-color);
  }
  
  .custom-cell {
    background-color: var(--bg-card) !important;
    border-color: var(--border-color) !important;
  }
  
  .custom-cell .van-cell__title,
  .custom-cell .van-cell__value {
    color: var(--text-primary) !important;
  }
  
  .popup-container {
    background: var(--bg-card) !important;
  }

  .record-btn {
    background: var(--bg-input);
    border-color: var(--border-color);
  }

  .mic-icon {
    color: var(--text-secondary) !important;
  }

  .record-text {
    color: var(--text-secondary);
  }
  
  .back-btn {
    color: var(--text-primary);
  }
  
  .footer {
    background-color: var(--bg-card);
    border-top-color: var(--border-color);
  }
  
  .t-collapse-panel {
    background-color: var(--bg-card) !important;
    border-color: var(--border-color) !important;
  }

  .delete-icon {
    background: rgba(239, 68, 68, 0.15);
  }
  
  .delete-icon:active {
    background: rgba(239, 68, 68, 0.25);
  }
}

/* ============================================
   Dark Mode - Manual Theme Toggle (.theme-dark)
   ============================================ */

/* 导航栏 */
.nav.theme-dark {
  background-color: rgba(22, 27, 34, 0.95);
  border-bottom-color: var(--border-color);
}

.nav.theme-dark .title {
  color: var(--text-primary);
}

.nav.theme-dark .back-btn {
  color: var(--text-primary) !important;
}

/* 头部区域 */
.header.theme-dark {
  color: var(--text-primary);
}

.header.theme-dark .header-word {
  background: var(--gradient-primary);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
}

.header.theme-dark .header-subtitle {
  color: var(--text-secondary);
}

.header.theme-dark .header-option {
  background-color: var(--bg-card);
  border-color: var(--border-color);
}

.header.theme-dark .source {
  background: rgba(93, 140, 245, 0.15);
  color: var(--primary);
}

.header.theme-dark .source-name {
  color: var(--text-muted);
}

/* Swiper 区域 */
.swiper-component.theme-dark {
  background-color: var(--bg-page);
}

/* 底部区域 */
.footer.theme-dark {
  background-color: var(--bg-card);
  border-top-color: var(--border-color);
}

.footer.theme-dark .btn-cancel-inner {
  background-color: var(--bg-input) !important;
  border-color: var(--border-color) !important;
  color: var(--text-secondary) !important;
}

.footer.theme-dark .btn-submit-inner {
  background: var(--gradient-primary) !important;
  color: #fff !important;
}

/* 弹出层 */
.popup-container.theme-dark {
  background: var(--bg-card) !important;
  color: var(--text-primary);
}

.popup-container.theme-dark .popup-title {
  color: var(--text-primary);
}

.popup-container.theme-dark .t-cell {
  background-color: var(--bg-input) !important;
}

/* 提示信息 */
.info-text.theme-dark {
  color: var(--text-muted);
  background-color: #0D1117;
}

.info-text.theme-dark .info-message {
  color: var(--text-muted);
}

/* 指示点 */
.custom-dots.theme-dark {
  background-color: #0D1117;
}

.custom-dots.theme-dark .dot {
  background-color: var(--border-color);
}

.custom-dots.theme-dark .dot.active {
  background: var(--gradient-primary);
}

.custom-dots.theme-dark .add-icon {
  color: var(--text-muted) !important;
}
